\usepackage{lmodern}
\usepackage[T1]{fontenc}

\usepackage{ifdraft}
\ifdraft{\usepackage{showkeys}}{}  % draftモードのときのみ参照キー表示
\usepackage{docmute} % ファイル分割
\usepackage{multicol} % 多段組
\usepackage{luacode} % {luacode*}環境
\usepackage[fleqn]{amsmath} % fleqn:数式の左寄せ, leqno:数式番号の左寄せ（(section番号).(数式番号)に書き換えるとalignなどで改行が入ってしまう）
%\usepackage{amsmath}
% \usepackage{ascmac} % 囲み環境
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
% \usepackage{mathrsfs} % 筆記体・花文字
\usepackage{bm}
\usepackage{mathtools}
\usepackage{enumitem} % 箇条書きなど
\usepackage{autobreak}
% \usepackage{comment} % comment環境(\if0 (hoge) \fi で十分)
% \usepackage{url} 
\usepackage{here} % 表などをその場所に表示させる\begin{figure}[H] (hoge) \end{figure}

\usepackage[unicode,pdfusetitle,hypertexnames=false]{hyperref} % ハイパーリンク
\usepackage{xcolor}
\hypersetup{
	colorlinks=true,
	citecolor=violet,
	linkcolor=teal,
	urlcolor=orange,
}

\usepackage{mleftright} % 括弧の調整
% \usepackage{exscale} % 異なるフォントサイズでの大型演算子のサポート

% \usepackage[framemethod = tikz, roundcorner = 5pt, linewidth = 3pt]{mdframed} % 囲み環境

%\usepackage{tikz}
%\usetikzlibrary{intersections, calc, arrows, cd}
%\usepackage{tikz-3dplot}

% \usepackage{diagbox} % 表中で斜線を表示
% \usepackage{lscape} % landscape環境を有効化

\usepackage{prooftrees} % 証明木

\newcommand{\pdiff}[2]{\frac{\partial #1}{\partial #2}} % 偏微分
\newcommand{\pdiffn}[3]{\frac{\partial^{#3} #1}{\partial #2^{#3}}} % n階偏微分
\newcommand{\diff}[2]{\frac{d #1}{d #2}} % 常微分
\newcommand{\diffn}[3]{\frac{d^{#3} #1}{d #2^{#3}}} % n階常備分
\newcommand{\substitute}[2]{\mleft. #1 \mright|_{#2}} % 代入
\newcommand{\Res}[2]{\underset{#2}{\mathrm{Res}}\pare{#1}} % 留数

\newcommand{\ele}{\bm{e}} % 単位ベクトル
\newcommand{\N}{\mathbb{N}} % 自然数全体
\newcommand{\Z}{\mathbb{Z}} % 整数全体
\newcommand{\Q}{\mathbb{Q}} % 有理数全体
\newcommand{\R}{\mathbb{R}} % 実数全体
\newcommand{\CC}{\mathbb{C}} % 複素数全体

\newcommand{\setN}[1][n]{\bm{N}_{#1}} % 0以上(n-1)以下の整数全体
\newcommand{\Rposi}{\mathbb{R}_{> 0}} % 正の実数
\newcommand{\Rnonnega}{\mathbb{R}_{\geq 0}} % 非負の実数

\newcommand{\pmat}[1]{\mleft(\begin{matrix} #1 \end{matrix}\mright)} % 括弧付きの行列
\newcommand{\mat}[1]{\begin{matrix} #1 \end{matrix}} % 括弧なしの行列
\newcommand{\vctr}[1]{\mleft(\begin{matrix} #1 \end{matrix}\mright)} % ベクトル(縦なら\vctr{a\\b\\c}，横なら\vctr{a&b&c}のように)
\DeclareMathOperator{\sgn}{\mathrm{sgn}} % 符号sgn
\DeclareMathOperator*{\argmax}{\arg\max} % argmax
\DeclareMathOperator*{\argmin}{\arg\min} % argmin

\newcommand{\trans}[1]{{}^t{#1}} % 転置

\newcommand{\spare}[1]{(#1)} % 小括弧
\newcommand{\pare}[1]{\mleft( #1 \mright)} % 括弧
\newcommand{\bra}[1]{\mleft\{ #1 \mright\} } % 中括弧
\newcommand{\squ}[1]{\mleft[ #1 \mright]} % 大括弧
\newcommand{\norm}[1]{\mleft\|#1\mright\|} %ノルム記号
\newcommand{\bsqu}[1]{\Bigl[ #1 \Bigr]} %大括弧 (積分などで強制的に大きくしたい場合)
\newcommand{\case}[1]{\mleft\{\begin{aligned}#1\end{aligned}\mright.} %場合分け

\newcommand{\abs}[1]{\mleft|#1\mright|} % 絶対値
\newcommand{\card}[1]{\mleft|#1\mright|} % 集合の濃度(個数)

%\newcommand{\relmiddle}[1]{\mathrel{}\middle#1\mathrel{}} % 集合の縦棒
%\newcommand{\set}[2]{\mleft\{ \rule{0pt}{10pt} \ #1 \relmiddle{|} #2\ \mright\}} % 集合
%\newcommand{\sset}[2]{\mleft\{ #1 \relmiddle{|} #2\mright\}} % 集合
\newcommand{\set}[2]{\mleft\{\rule{0pt}{9pt}\  #1 \ ; \  #2\ \mright\}} % 集合
\newcommand{\sset}[2]{\mleft\{ #1 \, ;\,  #2\mright\}} % 集合
\newcommand{\seq}[2]{\mleft\{#1\mright\}_{#2}} % 数列
\newcommand{\fset}[2]{\mleft\{#1\mright\}_{#2}} % 集合族
\newcommand{\gene}[1]{\mleft\langle #1 \mright\rangle} % 生成

\newcommand{\dummy}{\,\cdot\,} % ダミーのドット

\newcommand{\defarrow}{:\stackrel{\mathrm{def}}{\Longleftrightarrow}} % 定義矢印(同値矢印の上にdef)
\DeclareMathOperator{\ord}{\mathrm{ord}} % 元の位数

\newcommand{\SL}[2]{\mathrm{SL}_{#1}\pare{#2}} % 特殊線形群
\newcommand{\GL}[2]{\mathrm{GL}_{#1}\pare{#2}} % 一般線形群
\newcommand{\id}[1]{\mathrm{id}_{#1}} % 恒等写像
\newcommand{\Mat}[3]{\mathrm{Mat}\pare{#1,#2,#3}}
\newcommand{\fun}[2]{#1 \pare{#2}} % 関数
\newcommand{\Laplace}[1]{\mathcal{L}\mleft[ #1 \mright]} % Laplace変換
\newcommand{\Fourier}[1]{\mathcal{F}\mleft[ #1 \mright]} % Fourier変換

\newcommand{\Gauss}[4]{{}_2F_1\mleft[\mleft.
        \begin{matrix}
            #1, #2
            \\
            #3 
        \end{matrix}\, 
        \mright|\
        #4\,
    \mright]
} % Gaussの超幾何函数

\newcommand{\Kummer}[3]{{}_1F_1\mleft[\mleft.
        \begin{matrix}
            #1
            \\
            #2 
        \end{matrix}\, 
        \mright|\
        #3\,
    \mright]
} % Kummerの合流型超幾何函数

\newcommand{\pfq}[5]{{}_{#1}F_{#2}\mleft[\mleft.
    \begin{matrix}
        #3
        \\
        #4 
    \end{matrix}\,
    \mright|\
    #5\,
    \mright]
} % 一般化超幾何函数

\newcommand{\sGauss}[4]{{}_{2}F_{1}\mleft({#1},\, {#2}\,;\, {#3}\, ;\, {#4}\mright)} % インライン用のGaussの超幾何函数
\newcommand{\sKummer}[3]{{}_{1}F_{1}\mleft({#1}\,;\, {#2}\, ;\, {#3}\mright)} % インライン用のKummerの合流型超幾何函数
\newcommand{\spfq}[5]{{}_{#1}F_{#2}\mleft({#3}\,;\, {#4}\, ;\, {#5}\mright)} % インライン用の一般化超幾何函数

\newcommand{\GaussP}[5]{P\mleft\{\begin{array}{ccc}
    0 & 1 & \infty
    \\
    0 & 0 & #1
    \\
    #2 & #3 & #4
\end{array}\ #5\mright\}}

\newcommand{\GaussPB}[4]{P\mleft\{\begin{array}{ccc}
    0 & 1 & \infty
    \\
    0 & 0 & #1
    \\
    1 - #3 & #3 - #1 - #2 & #2
\end{array}\ #4\mright\}}

\makeatletter
\def\RiemannP#1#2#3#4#5#6#7#8#9{%
    \def\xx@RiemannP@temp@a{#1}%
    \def\xx@RiemannP@temp@b{#2}%
    \def\xx@RiemannP@temp@c{#3}%
    \def\xx@RiemannP@temp@d{#4}%
    \def\xx@RiemannP@temp@e{#5}%
    \def\xx@RiemannP@temp@f{#6}%
    \def\xx@RiemannP@temp@g{#7}%
    \def\xx@RiemannP@temp@h{#8}%
    \def\xx@RiemannP@temp@i{#9}%
    \xx@RiemannP@temp}
\def\xx@RiemannP@temp#1{P\mleft\{\begin{array}{ccc}%
    \xx@RiemannP@temp@a & \xx@RiemannP@temp@b & \xx@RiemannP@temp@c\\%
    \xx@RiemannP@temp@d & \xx@RiemannP@temp@e & \xx@RiemannP@temp@f\\%
    \xx@RiemannP@temp@g & \xx@RiemannP@temp@h & \xx@RiemannP@temp@i%
\end{array}\ #1\mright\}}
\makeatother

\newcommand{\poch}[2]{\mleft(#1\mright)_{#2}} % Pochhammer記号

\newcommand{\Poch}[2]{\frac{\Gamma\mleft(#1+#2\mright)}{\Gamma\mleft(#1\mright)}} % Pochhammer記号(Gamma函数表示)


\DeclareMathOperator{\cosech}{\mathrm{cosech}} % 1/sinh
\DeclareMathOperator{\limn}{\lim_{n\to\infty}} % lim_{n\to\infty}の略記

\newcommand{\Li}[2]{\mathrm{Li}_{#1}\mleft(#2\mright)} % 多重対数函数

\newcommand{\re}[1]{\mathrm{Re}\mleft(#1\mright)} % 実部
\newcommand{\im}[1]{\mathrm{Im}\mleft(#1\mright)} % 虚部

\newcommand{\inner}[2]{\mleft\langle #1\, \middle|\, #2 \mright\rangle} % 内積
\newcommand{\Bra}[1]{\mleft\langle #1\, \middle|\mright.} 
\newcommand{\Ket}[1]{\mleft. \middle|\, #1 \mright\rangle}

\newcommand{\diffun}[3]{{#1}^{\mleft({#2}\mright)}\mleft({#3}\mright)} % w^{(n)}(z) のような表記

\DeclareRobustCommand{\stir}{\genfrac\{\}{0pt}0} % 第1種Stirling数
\DeclareRobustCommand{\sstir}{\genfrac\{\}{0pt}1} % 第1種Stirlling数（インライン用）

\newcommand{\Schrodinger}{Schr\"odinger}






\newtheoremstyle{mystyle}%   % スタイル名
    {}%                      % 上部スペース
    {}%                      % 下部スペース
    {\normalfont}%           % 本文フォント
    {}%                      % インデント量
    {\textbf}%                   % 見出しフォント
    {}%                      % 見出し後の句読点, '.'
    { }%                     % 見出し後のスペース, ' ' or \newline
    {\underline{\thmname{#1}\thmnumber{#2}\thmnote{（#3）}}}%
                             % 見出しの書式 (can be left empty, meaning `normal')
\theoremstyle{mystyle} % スタイルの適用

% 定理環境の定義
\theoremstyle{definition}
\newtheorem{prob}{問}[chapter]
\newtheorem{thm}{定理}[chapter]
\newtheorem{defi}[thm]{定義}
\newtheorem{lem}[thm]{補題}
\newtheorem{rem}[thm]{注意}
\newtheorem{cor}[thm]{系}
\newtheorem{eg}[thm]{例}
\newtheorem{prop}[thm]{命題}
\newtheorem{nota}[thm]{記法}
\newtheorem{supple}[thm]{補足}

% showonlyrefsはwtrefやcleverefと相性が悪いので使わない
%\mathtoolsset{showonlyrefs=true} % 式番号を参照されたもののみ付ける

\usepackage{wtref} % 相互参照支援
% キーの定義
\newref{part,chap,sec,subsec,subsubsec}
\newref{equ,tab,fig}
\newref{thm,prob,defi,lem,cor,eg,prop,nota,supple}

% 参照名の定義
\setrefstyle{part}{prefix=第, suffix=部}
\setrefstyle{chap}{prefix=第, suffix=章}
\setrefstyle{sec}{prefix=第, suffix=節}
\setrefstyle{subsec}{prefix=第, suffix=小節}
\setrefstyle{subsubsec}{prefix=第, suffix=小々節}

\setrefstyle{equ}{refcmd=(\ref{#1}), prefix=式}
\setrefstyle{tab}{prefix=表}
\setrefstyle{fig}{prefix=図}

\setrefstyle{prob}{prefix=問}
\setrefstyle{thm}{prefix=定理}
\setrefstyle{defi}{prefix=定義}
\setrefstyle{lem}{prefix=補題}
\setrefstyle{cor}{prefix=系}
\setrefstyle{eg}{prefix=例}
\setrefstyle{prop}{prefix=命題}
\setrefstyle{nota}{prefix=記法}
\setrefstyle{supple}{prefix=補足}

% 問題と解答の連動
\def\ans#1{\vspace{5pt}\par\noindent\textbf{問\ref{prob:#1}.}}
\def\endans{\vspace{5pt}\par}


\if0
% 式参照した場合auxに書き込み（これをしないと\mathtoolsset{showonlyrefs=true}と共存できない）
\makeatletter
\let\xx@temp\equref
\def\equref#1{\xx@temp{#1}%
\immediate\write\@auxout{\string\MT@newlabel{equ:#1}}}
\makeatother
\fi

% 式番号をchapterごとにつける
\makeatletter
\@addtoreset{equation}{chapter}
\def\theequation{\thechapter.\arabic{equation}}
% 表, 図番号をchapterごとにつける
\@addtoreset{table}{chapter}
\def\thetable{\thechapter.\arabic{table}}
\@addtoreset{figure}{chapter}
\def\thefigure{\thechapter.\arabic{figure}}
\makeatother

\if0
% 式番号をsectionごとにつける
\makeatletter
\@addtoreset{equation}{section}
\def\theequation{\thesection.\arabic{equation}}
% 表, 図番号をsectionごとにつける
\@addtoreset{table}{section}
\def\thetable{\thesection.\arabic{table}}
\@addtoreset{figure}{section}
\def\thefigure{\thesection.\arabic{figure}}
\makeatother
\fi

% \parindent = 0pt
\allowdisplaybreaks[1] % 数式途中の改ページを許すかどうか(0:許さない, 1~3:値が大きいほど規制がゆるい)


% 余白の設定
\setlength{\textwidth}{\fullwidth}
\setlength{\evensidemargin}{\oddsidemargin}


\setcounter{tocdepth}{4}  % subsubsectionまで表示
