\documentclass[b5paper,draft]{ltjsbook}
%\documentclass[b5paper]{ltjsbook}
\usepackage{../Preamble/preamble}
\begin{document}
\ifdraft{\tableofcontents}{}
\section{実線型空間上のノルム}\seclabel{実線型空間上のノルム}
ノルムに関する以下の定義や命題は\cite{nomura}に拠る。

\begin{defi}[ノルム]\defilabel{実ノルム-定義}
    $V$を$\R$上の線型空間とする。
    $\abs{\dummy}$を実数の絶対値とする。
    関数$\norm{\dummy}\colon V\to \R$が以下の条件を満たすとき，$\norm{x}$を$x$のノルムという：
    \begin{enumerate}[label=(\roman*)]
        \item （正値性） $\forall x\in V,\ \norm{x}\geq 0$
        \item （一意性） $\forall x\in V,\ \bsqu{\norm{x}=0\ \Longleftrightarrow\ x=0}$
        \item （同次性） $\forall k\in \R,\ \forall x\in V,\ \norm{kx}=\abs{k}\norm{x}$
        \item （三角不等式） $\forall x, \forall y\in V,\ \norm{x+y}\leq \norm{x}+\norm{y}$
    \end{enumerate}
\end{defi}

ノルムの定義された線型空間をノルム空間という。


\begin{prop}[三角不等式]\proplabel{実ノルム-三角不等式}
    ノルムは次の性質も満たす：
    \begin{equation}
        \forall x, \forall y\in V,\ \abs{\norm{x}-\norm{y}}\leq \norm{x-y}.
    \end{equation}
    \begin{proof}
        まず，$\norm{x}=\norm{\pare{x-y}+y}\leq \norm{x-y}+\norm{y}$
        から$\norm{x}-\norm{y}\leq \norm{x-y}$
        が従う。
        同様に
        \begin{equation}
            \norm{y}=\norm{\pare{y-x}+x}\leq \norm{\pare{-1}\pare{x-y}}+\norm{x}=\abs{-1}\norm{x-y}+\norm{x}=\norm{x-y}+\norm{x}
        \end{equation}
        なので，$\norm{y}-\norm{x}\leq \norm{x-y}$である。
        また，絶対値の特徴付け$\abs{a}= \max\bra{a,-a}$
        を用いると，$ \max\bra{\norm{x}-\norm{y},\norm{y}-\norm{x}} = \abs{\norm{x}-\norm{y}}\leq \norm{x-y}$である。
        これらにより，$\abs{\norm{x}-\norm{y}}\leq \norm{x-y}$が成立する。
    \end{proof}
\end{prop}

\begin{cor}\corlabel{実ノルム-三角不等式}
    \propref{実ノルム-三角不等式}において，$y\mapsto -y$として，元の三角不等式と併せれば，
    \begin{equation}
        \abs{\norm{x}-\norm{y}}\leq \norm{x+y}\leq \norm{x}+\norm{y}
    \end{equation}
    が従う。
\end{cor}

\begin{prop}[ノルムの連続性]\proplabel{実ノルム-連続性}
    ノルムは連続関数である。
    \begin{proof}
        示すべきことは以下の通り（\defiref{Lipschitz-関数の連続性}も参照）：
        \begin{equation}
            \forall x,\forall y\in V,\ \forall \varepsilon\in\Rposi,\
                \exists \delta\in \Rposi;\ \bsqu{
                    \norm{x-y}<\delta\, \Longrightarrow\, \abs{\norm{x}-\norm{y}}<\varepsilon
                }.
        \end{equation}

        実際，$\delta\coloneqq \varepsilon$と取れば，\propref{実ノルム-三角不等式}により，$\abs{\norm{x}-\norm{y}}\leq \norm{x-y}<\delta =\varepsilon$であるから，ノルムは連続関数である。
    \end{proof}
\end{prop}

\begin{defi}[ノルムの同値性]\defilabel{実ノルム-ノルムの同値性}
    以下が成立するとき，$V$上の2つのノルム$\norm{\dummy}$, $\norm{\dummy}_1$が同値であるという：
    \begin{equation}
        \exists m, \exists M\in\R;\ \bsqu{0<m\leq M\ \land \ \pare{
            \forall x\in V,\ m\norm{x}_1 \leq \norm{x} \leq M\norm{x}_1
        }}.
    \end{equation}
\end{defi}

\begin{prop}\proplabel{実ノルム-同値関係}
    ノルムの同値性は同値関係である。
    \begin{proof}
        ノルム$\norm{\dummy}$, $\norm{\dummy}_1$が同値であることを$\norm{\dummy}\sim\norm{\dummy}_1$と記すことにする。
        すなわち，
        \begin{equation}
            \norm{\dummy}\sim\norm{\dummy}_1\ \defarrow\ \exists m, \exists M\in\R;\ \bsqu{0<m\leq M\ \land \ \pare{
                \forall x\in V,\ m\norm{x}_1 \leq \norm{x} \leq M\norm{x}_1
            }}.
        \end{equation}
        このとき関係$\sim$が反射律，対称律，推移律を満たすことを示す。
        \begin{itemize}
            \item （反射律）
            任意の$\norm{\dummy}$に対し，$\norm{\dummy}\sim\norm{\dummy}$が成立することを示す。
            実際，$m=M=1$とすれば，
            \begin{equation}
                0<m=1\leq M=1\ \land\ \pare{\forall x\in V,\ 1\cdot \norm{x}\leq \norm{x}\leq 1\cdot \norm{x}}
            \end{equation}
            であるから成立。

            \item （対称律）
            $\norm{\dummy}\sim\norm{\dummy}_1$，すなわち
            \begin{equation}
                \exists m, \exists M\in\R;\ \bsqu{0<m\leq M\ \land \ \pare{
                \forall x\in V,\ m\norm{x}_1 \leq \norm{x} \leq M\norm{x}_1
                }}
            \end{equation}
            のとき，$\norm{\dummy}_1\sim\norm{\dummy}$が成立することを示す。
            後半の不等式を書き直すと，$\frac{1}{M}\norm{x}\leq \norm{x}_1\leq \frac{1}{m}\norm{x}$であり，$0<m\leq M$であるから$0<\frac{1}{M}\leq \frac{1}{m}$であり，$m' \coloneqq \frac{1}{M}$, $M' \coloneqq  \frac{1}{m}$と取れば確かに$\norm{\dummy}_1\sim\norm{\dummy}$の成立が判る。

            \item （推移律）
            3つのノルム$\norm{\dummy}$, $\norm{\dummy}_1$, $\norm{\dummy}_2$に対し，$\norm{\dummy}\sim \norm{\dummy}_1$と$\norm{\dummy}_1\sim \norm{\dummy}_2$のとき，$\norm{\dummy}\sim \norm{\dummy}_2$が成立することを示す。
            仮定から，
            \begin{align}
                &\exists m_1, \exists M_2\in\R;\ \bsqu{0<m_1\leq M_2\ \land \ \pare{
                \forall x\in V,\ m_1\norm{x}_1 \leq \norm{x} \leq M_1\norm{x}_1
                }},
                \\
                &\exists m_2, \exists M_2\in\R;\ \bsqu{0<m_2\leq M_2\ \land \ \pare{
                \forall x\in V,\ m_2\norm{x}_2 \leq \norm{x}_1 \leq M_2\norm{x}_2
                }}
            \end{align}
            の両方が成立しているから，$\norm{x}\leq M_1\norm{x}_1\leq M_1M_2\norm{x}_2$及び，$\norm{x}\geq m_1\norm{x}_1\geq m_1m_2 \norm{x}_2$より，$m_1m_2\norm{x}_2\leq \norm{x}\leq M_1M_2\norm{x}_2$が従う。
            これより，$m\coloneqq m_1m_2$, $M\coloneqq M_1M_2$と取れば$0<m_1m_2\leq M_1M_2$も成立するので$\norm{\dummy}\sim \norm{\dummy}_2$である。
        \end{itemize}

        以上により，ノルムの同値性は同値関係である。
    \end{proof}
\end{prop}

\begin{thm}\thmlabel{実ノルム-同値性}
    線型空間$V$が有限次元であれば，$V$上の任意の2つのノルムは同値である。
    \begin{proof}
        $V$を有限次元線型空間とし，$n\coloneqq \dim{V}$とする。
        $V$の基底として，$\seq{\ele_k}{0\leq k\leq n-1}$を取り固定する。
        $V$の元$x$を，$x =\sum_{k=0}^{n-1} x_k \ele_k$と表したときの成分$\seq{x_k}{0\leq k\leq n-1}$を用いて，
        \begin{equation}
            \norm{\dummy}\colon V\to \R;\ x\mapsto \norm{x}\coloneqq \max_{0\leq k\leq n-1}\bra{\abs{x_k}}
            \equlabel{実ノルム-max}
        \end{equation}
        と定めると$\norm{\dummy}$はノルムになる。
        以下$\norm{\dummy}$がノルムであることを確かめる：
        \begin{enumerate}[label=(\roman*)]
            \item （正値性）
            どの$k$についても$0\leq \abs{x_k}$であり，$\displaystyle\norm{x}= \max_k\bra{\abs{x_k}}\geq 0$であるから成立。

            \item （一意性）
            $x=0$のとき，どの$k$についても$x_k=0$であるから$\displaystyle\norm{x}= \max_k\bra{\abs{x_k}}=0$である。
            また，$\norm{x}=0$のとき，任意の$k$に対し，絶対値の非負性から$0\leq \abs{x_k}$であって，$\abs{x_k}\leq {x}=0$であるから$\abs{x_k}=0$である。
            これより$x=0$となる。

            \item （同次性）
            絶対値の非負性と同次性から，$\displaystyle\norm{cx}=\max_k \bra{\abs{cx}}=\abs{c}\cdot \max_k\bra{\abs{x_k}}=\abs{c}\norm{x}$が従う。

            \item （三角不等式）
            絶対値の三角不等式から，各$k$に対して$\abs{x_k+y_k}\leq \abs{x_k}+\abs{y_k}$であるから最大値に関してもこの不等号が成り立つので$\norm{x+y}\leq \norm{x}+\norm{y}$が従う。
        \end{enumerate}
        以上により\equref{実ノルム-max}で定められた$\norm{\dummy}$はノルムである。

        次に，$V$上の勝手なノルム$\norm{\dummy}_1$を取ってきたときに，\equref{実ノルム-max}で定義した$\norm{\dummy}_1$と$\norm{\dummy}$が同値になってしまうことを示す。
        $V$のコンパクト集合$S$を$S\coloneqq \sset{y\in V}{\norm{y}=1}$
        によって定め，関数$f\colon S\to \R$を$\fun{f}{y}\coloneqq \norm{y}_1$と定める。
        $f$の連続性（\propref{実ノルム-連続性}）と$S$がコンパクト集合であることから，$f$の値域には最小元$m$と最大元$M$が存在する。
        $S$上で$y\ne {0}$であり，ノルムの正値性から$0<m\leq M$である。
        特に，$\norm{y}=1$ならば$y\in S$であり，$m$, $M$の定義から$m\leq \fun{f}{y}\leq M$及び$\fun{f}{y}=\norm{y}_1$なので$m\leq \norm{x}_1\leq M$が従う。
        ここで，$V$上の一般の$x\ne 0$に対して$y\coloneqq x / \norm{x}$とすると$\norm{y}=\norm{x/\norm{x}}=\norm{x}/\norm{x}=1$より$y\in S$であるから$\fun{f}{y}=\norm{x/\norm{x}}_1=\norm{x}_1/\norm{x}$であって，$m\leq \norm{x}_1/\norm{x}\leq M$より$m\norm{x}\leq \norm{x}_1\leq M\norm{x}$である。
        $x=0$についても$\norm{0}=\norm{0}_1=0$であって，$m \norm{0}_1\leq \norm{0}\leq M\norm{0}_1$は成立するので，$\norm{\dummy}_1$と$\norm{\dummy}$は同値である。

        有限次元線型空間$V$上で与えられた任意の2つのノルム$\norm{\dummy}_1$, $\norm{\dummy}_2$はそれぞれ\equref{実ノルム-max}で定義された$\norm{\dummy}$と同値であり，ノルムの同値は同値関係（\propref{実ノルム-同値関係}）なので，$\norm{\dummy}_1$と$\norm{\dummy}_2$も同値である。
    \end{proof}
\end{thm}


\subsection{実線型空間上のノルム}\subseclabel{実ノルム-実線型空間上のノルム}
上ではノルムに関して，一般的な形でやや抽象的に述べた。
以降では\cite{takano}に基づいて，常微分方程式を実際に扱う際に有用なノルムを具体的に扱う。
ここでは有限次元実線型空間$\R^n$上のノルムの例を挙げる。
以下では，$x=\pare{x_0,x_1,\dots,x_{n-1}}$の各成分を実数とし，$\abs{\dummy}$を実数の絶対値とする。

\begin{eg}[Euclidノルム]\eglabel{実ノルム-Euclidノルム}
    原点からの標準的な距離：
    \begin{equation}
        \norm{x}_2\coloneqq \pare{\sum_{k=0}^{n-1} \abs{x_k}^2}^{\frac{1}{2}}
    \end{equation}
    はノルムである。
\end{eg}

\begin{eg}[一様ノルム]\eglabel{実ノルム-一様}
    \thmref{実ノルム-同値性}の証明において\equref{実ノルム-max}で定義された
    $\norm{\dummy}$はノルムである。
    後述するように，$p$ノルムにおいて$p\to\infty$の極限で再現されることから，これを$\norm{\dummy}_\infty$と書いて$\infty$ノルムとも呼ぶ。
\end{eg}

\begin{defi}[$p$ノルム]\defilabel{実ノルム-pノルム}
    $p$を$1$以上の実数とする。
    このとき，$x$の$p$ノルム$\norm{x}_p$を，
    \begin{equation}
        \norm{x}_p \coloneqq \pare{\sum_{k=0}^{n-1} \abs{x_k}^p}^{\frac{1}{p}}
    \end{equation}
    で定める。
\end{defi}

\begin{prob}\problabel{実ノルム-pノルムがノルムであることの証明}
    $p$ノルムがノルムの条件（\defiref{実ノルム-定義}）を満たしていることを確かめよ。
\end{prob}

$1$ノルムのことを絶対値ノルムと呼び，絶対値ノルムによって定まる距離をManhattan距離と呼ぶ。
$2$ノルムはEuclidノルムに一致する。

\begin{prop}\proplabel{実ノルム-pノルムが一様ノルムに収束する}
    $p\to\infty$の極限で$p$ノルム$\norm{\dummy}_p$は\egref{実ノルム-一様}の一様ノルム$\norm{\dummy}_\infty$に一致する。
    \begin{proof}
        $x_M$は$x$の成分の$x_0,x_1,\dots,x_{n-1}$のうち絶対値が最大のものであるとする。
        このとき，$\abs{x_M}=\norm{x}_\infty$と書ける。
        定義より，
        \begin{equation}
            \norm{x}_p=\pare{\sum_{k=0}^{n-1}\abs{x_k}^p}^{\frac{1}{p}},\quad
            \norm{x}_\infty=\max_{0\leq k\leq n-1}\bra{\abs{x_k}}=\abs{x_M}
        \end{equation}
        であるから，
        示すべきことは，
        \begin{equation}
            \pare{\sum_{k=0}^{n-1}\abs{x_k}^p}^{\frac{1}{p}}\to \abs{x_M}\quad\pare{p\to\infty}
            \equlabel{実ノルム-pノルムの極限}
        \end{equation}
        である。
        まず，$1<p<\infty$のとき，$\norm{x}_\infty \leq \norm{x}_p$であることを確かめる。
        これは，
        \begin{equation}
            0\leq \abs{x_M}^p\leq \sum_{k=0}^{n-1}\abs{x_k}^p
        \end{equation}
        であることと，$0<p$のとき，$t\in \mleft[0,\infty\mright)$において$\fun{f}{t}=t^{\frac{1}{p}}$が狭義単調増加であること，$0$以上$(n-1)$以下の任意の整数$k$について$\abs{x_k}\geq 0$であることから，
        \begin{equation}
            \abs{x_M}=\pare{\abs{x_M}^p}^{\frac{1}{p}}\leq \pare{\sum_{k=0}^{n-1}\abs{x_k}^p}^{\frac{1}{p}}
        \end{equation}
        より成立。
        また，$0$以上$(n-1)$以下の任意の整数$k$について$0\leq \abs{x_k}\leq \abs{x_M}$であり，
        \begin{equation}
            0\leq \sum_{k=0}^{n-1} \abs{x_k}^p\leq \sum_{k=0}^{n-1}\abs{x_M}^p=n\abs{x_M}^p
        \end{equation}
        が成立する。
        更に，$n$は固定された正整数であるから
        \begin{equation}
            n^{\frac{1}{p}}\to n^0=1\quad\pare{p\to\infty}
        \end{equation}
        である。

        これらのことから，
        \begin{equation}
            0\leq \pare{\sum_{k=0}^{n-1}\abs{x_k}^p}^{\frac{1}{p}}-\abs{x_M}
            \leq \pare{n\abs{x_M}^p}^{\frac{1}{p}}-\abs{x_M}
            \leq \pare{n^{\frac{1}{p}}-1}\abs{x_M}
            \to 0\quad\pare{p\to\infty}
        \end{equation}
        が従い，はさみうちの原理から，
        \begin{equation}
            \pare{\sum_{k=0}^{n-1}\abs{x_k}^p}^{\frac{1}{p}}\to \abs{x_M}\quad\pare{p\to\infty}
        \end{equation}
        であり，これは\equref{実ノルム-pノルムの極限}の成立を意味している。
    \end{proof}
\end{prop}

以降，有限次元線型空間のノルムは\egref{実ノルム-一様}の一様ノルムであるとする。

\begin{nota}\notalabel{実ノルム-n-1以下の整数}
    以下では簡単のために，$n-1$以下の非負整数の集合を，
    \begin{equation}
        \setN\coloneqq \set{j}{j\in\N\ \land\  0\leq j\leq n-1}
    \end{equation}
    と書く。
\end{nota}


\begin{prop}\proplabel{実ノルム-積分の不等式}
    $I$を$\R$上の閉区間であるとする。
    $f\colon I\to \R^n$を連続なベクトル値関数とするとき，
    \begin{equation}
        \norm{\int_I dt\, \fun{f}{t}}\leq \int_I dt\, \norm{\fun{f}{t}}
    \end{equation}
    が成立する。
    \begin{proof}
        $I$上可積分な$g\colon I\to \R$と絶対値に関する以下の不等式：
        \begin{equation}
            \abs{\int_I dt\, \fun{g}{t}}\leq \int_I dt\, \abs{\fun{g}{t}}
            \equlabel{実ノルム-積分絶対値不等式}
        \end{equation}
        を用いる。
        \begin{equation}
            \forall j\in \setN,\, \forall t\in I,\ 
            \fun{f_j}{t}\leq \abs{\fun{f_j}{t}}\leq \norm{\fun{f}{t}}
        \end{equation}
        であるから，
        \begin{equation}
            \forall j\in \setN,\ 
            \int_I dt\, \fun{f_j}{t}\leq \int_I dt\, \abs{\fun{f_j}{t}}
            \leq \int_I dt\, \norm{\fun{f}{t}}
        \end{equation}
        である。
        ここで，\equref{実ノルム-積分絶対値不等式}の不等式から，
        \begin{equation}
            \abs{\int_I dt\, \fun{f_j}{t}}\leq \int_I dt\, \abs{\fun{f_j}{t}}\leq \int_I dt\, \norm{\fun{f}{t}}
        \end{equation}
        であるから，
        \begin{equation}
            \norm{\int_I dt \, \fun{f}{t}}
            =\max_{0\leq j\leq n-1}\bra{\abs{\int_I dt\, \fun{f_j}{t}}}\leq \int_I dt\, \norm{\fun{f}{t}}
        \end{equation}
        が成立する。
    \end{proof}
\end{prop}

\if0
\begin{lem}
    $S_1$, $S_2$を適当な集合とし，写像$f\colon S_1\times S_2\to \R$を与え，$T_1$, $T_2$をそれぞれ$S_1$, $S_2$の部分集合とする。
    このとき，
    \begin{equation}
        \sup_{a\in T_1}\bra{\max_{b\in T_2}\bra{\fun{f}{a,b}}}
        =\max_{b\in T_2}\bra{\sup_{x\in a_1}\bra{\fun{f}{a,b}}}
    \end{equation}
    が成立する。
    \begin{proof}
        \begin{prooftree}
            {
                close with={\times},
                to prove={
                    \pare{\pare{\forall a} \pare{p(a) \to \pare{\pare{\forall b} \pare{ q(b) \to r(a,b)}}}}
                    \vdash
                    \pare{\pare{\forall b} \pare{q(b) \to \pare{\pare{\forall a} \pare{ p(a) \to r(a,b)}}}},
                }
            }
            [
                \pare{\forall a} \pare{p(a) \to \pare{\pare{\forall b} \pare{ q(b) \to r(a,b)}}}, just={Assumption}, name={1}
                    [\lnot\pare{\pare{\forall b} \pare{q(b) \to \pare{\pare{\forall a} \pare{ p(a) \to r(a,b)}}}}, just={$\lnot$ Conclusion}
                    [\lnot\pare{q(b')\to\pare{\pare{\forall a}\pare{p(a)\to r(a,b')}}}, just={$\lnot\pare{\forall b}$ {}:!u}
                        [q(b'), just={$\lnot \to$ {}:!u}, name={4}
                            [\lnot\pare{\pare{\forall a}\pare{p(a)\to r(a,b')}}, just={$\lnot \to$ {}:!uu}
                                [\lnot\pare{p(a')\to r(a',b')}, just={$\lnot\pare{\forall a}$ {}:!u}
                                    [p(a'), just={$\lnot \to$ {}:!u}, name={7}
                                        [{\lnot r(a',b')}, just={$\lnot\to$ {}:!uu}, name={8}
                                            [p(a') \to \pare{\pare{\forall b}\pare{q(b)\to r(a',b)}}, just={$\pare{\forall a}$ {}:1} 
                                                [\lnot p(a'), just={$\to$ {}:!u}, close={:7,!c}]
                                                [\pare{\forall b}\pare{q(b)\to r(a',b)}
                                                [{q(b')\to r(a',b')}, just={$\pare{\forall b}$ {}:!u}
                                                    [\lnot q(b'), , just={$\to$:!u},close={:4,!c}]
                                                    [{r(a',b')}, close={:8,!c}]
                                                ]
                                                ]
            ]]]]]]]]]
        \end{prooftree}
    \end{proof}
\end{lem}
\fi

\begin{defi}[作用素ノルム]\defilabel{実ノルム-作用素ノルム}
    線型作用素$A\colon \R^n\to\R^n$に対して，$\norm{A}$を，
    \begin{equation}
        \norm{A}\coloneqq \sup_{\norm{x}=1}\bra{\norm{Ax}}
    \end{equation}
    で定める。
\end{defi}

以降，$A$を線型作用素とし，その$\pare{j,k}$成分を$a_{jk}$と書く。

\begin{prop}\proplabel{実ノルム-作用素ノルム具体形}
    \begin{equation}
        \norm{A} = \max_{0\leq j\leq n-1} \bra{\sum_{k=0}^{n-1} \abs{a_{jk}}}
    \end{equation}
    \begin{proof}
        $\norm{x}=1$のとき，$x$の各成分の絶対値は$1$以下である。
        このとき，$Ax$の第$j$成分$\pare{Ax}_j$に関して，
        \begin{equation}
            \abs{\pare{Ax}_j}=\abs{\sum_{k=0}^{n-1}a_{jk} x_k}
            \leq \sum_{k=0}^{n-1}\abs{a_{jk}}\abs{x_k}\leq \sum_{k=0}^{n-1}\abs{a_{jk}}
        \end{equation}
        となり，1つ目の等号成立は，
        \begin{equation}
            \bsqu{\forall k\in\setN,\ a_{jk}x_k\geq 0}
            \ \lor\ 
            \bsqu{\forall k\in\setN,\ a_{jk}x_k\leq 0}
        \end{equation}
        のとき，すなわち$a_{jk}x_k$が全て同符号のときである。
        2つ目の等号成立は，$x$の各成分の絶対値が$1$に等しい場合であり，この2つの条件は同時に満たすことができる。
        実際，各$k$について，$a_{jk}\geq 0$なら$x_k=1$とし，$a_{jk}<0$なら$x_k=-1$と定めれば，いずれの等号も成立する。
        これより，
        \begin{equation}
            \norm{A} = \max_{0\leq j\leq n-1} \bra{\sum_{k=0}^{n-1} \abs{a_{jk}}}
        \end{equation}
        である。
    \end{proof}
\end{prop}

\begin{prop}\proplabel{実ノルム-作用素ノルム不等式1}
    \begin{equation}
        \forall x\in \R^n,\ \norm{Ax}\leq \norm{A}\norm{x}
    \end{equation}
    \begin{proof}
        各$k$について$\abs{x_k}\leq \norm{x}$であるから，
        $Ax$の第$j$成分について，
        \begin{equation}
            \abs{\pare{Ax}_j}=\abs{\sum_{k=0}^{n-1}a_{jk}x_k}
            \leq \sum_{k=0}^{n-1} \abs{a_{jk}}\abs{x_k}
            \leq \pare{\sum_{k=0}^{n-1}\abs{a_{jk}}}\cdot \norm{x}
        \end{equation}
        が成立して，
        \begin{equation}
            \forall x\in \R^n,\ \norm{Ax}\leq \norm{A}\norm{x}
        \end{equation}
        が従う。
    \end{proof}
\end{prop}

\begin{prop}\proplabel{実ノルム-作用素ノルム三角不等式}
    $A$, $B$を$\R^n$から$\R^n$への任意の線型作用素とする。
    このとき，
    \begin{equation}
        \norm{A+B}\leq \norm{A}+\norm{B},\ \norm{AB}\leq \norm{A}\norm{B}
    \end{equation}
    が成立する。
    \begin{proof}
        $A$, $B$の$\pare{j,k}$成分をそれぞれ$a_{jk}$, $b_{jk}$とする。
        まず，
        \begin{equation}
            \sum_{k=0}^{n-1}\abs{a_{jk}+b_{jk}}
            \leq \sum_{k=0}^{n-1}\abs{a_{jk}}
            +\sum_{k=0}^{n-1}\abs{b_{jk}}
        \end{equation}
        であるから，
        \begin{equation}
            \max_{0\leq j\leq n-1}\bra{\sum_{k=0}^{n-1}\abs{a_{jk}+b_{jk}}}
            \leq \max_{0\leq j\leq n-1}\bra{\sum_{k=0}^{n-1}\abs{a_{jk}}}
            +\max_{0\leq j\leq n-1}\bra{\sum_{k=0}^{n-1}\abs{b_{jk}}}
        \end{equation}
        であり，$\norm{A+B}\leq \norm{A}+\norm{B}$である。
        
        次に，$m$は，
        \begin{equation}
            \forall \ell\in \setN,\
            \sum_{k=0}^{n-1}\abs{b_{\ell k}}\leq
            \sum_{k=0}^{n-1}\abs{b_{m k}}
        \end{equation}
        を満たす，すなわち$\norm{B}$を与える行の添字とする。
        このとき，
        \begin{equation}
            \sum_{k=0}^{n-1}\abs{\sum_{\ell=0}^{n-1}a_{j\ell}b_{\ell k}}
            \leq \sum_{k=0}^{n-1}\pare{\sum_{\ell=0}^{n-1}\abs{a_{j\ell}}\abs{b_{\ell k}}}
            =\sum_{\ell=0}^{n-1}\pare{\abs{a_{j\ell}}\sum_{k=0}^{n-1}\abs{b_{\ell k}}}
            \leq \pare{\sum_{\ell=0}^{n-1}\abs{a_{j\ell}}}
            \pare{\sum_{k=0}^{n-1}\abs{b_{mk}}}
        \end{equation}
        より，
        \begin{equation}
            \max_{0\leq j\leq n-1}\bra{\sum_{k=0}^{n-1}\abs{\sum_{\ell=0}^{n-1}a_{j\ell}b_{\ell k}}}
            \leq \max_{0\leq j\leq n-1}\bra{\sum_{\ell=0}^{n-1}\abs{a_{j\ell}}}\cdot \max_{0\leq m\leq n-1}\bra{\sum_{k=0}^{n-1}\abs{b_{mk}}}
        \end{equation}
        が従うので，
        $\norm{AB}\leq \norm{A}\norm{B}$である。
    \end{proof}
\end{prop}

\begin{prop}\proplabel{実ノルム-作用素ノルムはノルム}
    \defiref{実ノルム-作用素ノルム}で定義した$\norm{A}$はノルムである。
    \begin{proof}
        及び，\propref{実ノルム-作用素ノルム三角不等式}
        \defiref{実ノルム-定義}の4条件を順に確かめる。
        \begin{enumerate}[label=(\roman*)]
            \item （正値性）
            \propref{実ノルム-作用素ノルム具体形}から，各項にある絶対値は非負なので，$\norm{A} \geq 0$である。

            \item （一意性）
            \propref{実ノルム-作用素ノルム具体形}から，$\norm{A}=0$だとすれば，絶対値の非負性から，どの$j$に関しても$\sum_{k=0}^{n-1}\abs{a_{jk}}=0$であり，これが成立するためには全ての$\pare{j,k}$に関して$A_{jk}=0$でなければならず，このとき$A=O$（零行列）である。

            \item （同次性）
            \propref{実ノルム-作用素ノルム具体形}から，
            \begin{equation}
                \norm{cA}=\max_{0\leq j\leq n-1} \bra{\sum_{k=0}^{n-1} \abs{c}\abs{a_{jk}}}=\abs{c}\cdot \max_{0\leq j\leq n-1} \bra{\sum_{k=0}^{n-1} \abs{a_{jk}}}=\abs{c}\norm{A}.
            \end{equation}

            \item （三角不等式）
            \propref{実ノルム-作用素ノルム三角不等式}から直ちに従う。
        \end{enumerate}
    \end{proof}
\end{prop}



\begin{prob}\problabel{実ノルム-その1}
    $\R^n$のベクトル$x$のノルムは\egref{実ノルム-一様}で述べた一様ノルムとし，
    $\R^n$上の線型作用素$A$のノルムは\defiref{実ノルム-作用素ノルム}で与えられた作用素ノルムであるとする。
    $n=3$のとき，
    \begin{equation}
        x=\vctr{-1\\3\\-4},\
        A=\pmat{1 & -1 & 4\\
            2 & -2 & 3\\
            -2 & -3 & 0
            }
    \end{equation}
    とする。
    このとき，$\norm{x}$と$\norm{A}$を計算せよ。
\end{prob}

\begin{prob}\problabel{実ノルム-その2}
    $\R^n$のベクトルに対して一様ノルムではなく，\egref{実ノルム-Euclidノルム}で導入したEuclidノルムを用いた場合，\defiref{実ノルム-作用素ノルム}で定義される$\norm{A}$はどのような性質を持つだろうか。
    例えば，$\R^2$上の一般的な線型作用素の作用素ノルムを，その成分を用いて具体的に表わせ。
    （関連：スペクトルノルム）
\end{prob}

%%% 複素数上でのノルムは次のchapterで

\section{Lipschitz連続}\seclabel{Lipschitz連続}
$m$, $n$を正整数とする。
$A\subseteq \R^m$とし，$f\colon A\to \R^n$について考える。

\begin{defi}[連続性]\defilabel{Lipschitz-関数の連続性}
    $f$が$A$上連続であるとは，
    \begin{equation}
        \forall \varepsilon\in\Rposi,\, \forall x\in A,\, \exists \delta \in \Rposi;\, \forall y \in A,\ \bsqu{
            \norm{x-y}<\delta \ \Longrightarrow\ \norm{\fun{f}{x}-\fun{f}{y}}<\varepsilon
        }
    \end{equation}
    が成立することである。
\end{defi}

\begin{defi}[一様連続性]
    $f$が$A$上一様連続であるとは，
    \begin{equation}
        \forall \varepsilon\in\Rposi,\, \exists \delta \in \Rposi;\,  \forall x, \forall y \in A,\ \bsqu{
            \norm{x-y}<\delta \ \Longrightarrow\ \norm{\fun{f}{x}-\fun{f}{y}}<\varepsilon
        }
    \end{equation}
    が成立することである。
\end{defi}

\begin{defi}[Lipschitz連続]\defilabel{Lipschitz-Lipschitz連続}
    $f$が$A$上Lipschitz連続であるとは，
    \begin{equation}
        \exists L\in \Rnonnega;\, \forall x, \forall y \in A,\ \bsqu{
            \norm{\fun{f}{x}-\fun{f}{y}}\leq L \norm{x - y}
        }
    \end{equation}
    が成立することである。
    このとき，$L$をLipschitz定数という。
\end{defi}

\begin{rem}
    Lipschitz定数は一意的ではない。
    実際，$L$がLipschitz定数のとき，$c>1$を用いると$\norm{\fun{f}{x}-\fun{f}{y}}\leq L \norm{x - y}\leq cL \norm{x-y}$も成立するので，$(L\neq )cL$もLipschitz定数である。
    上の条件を満たすLipschitz定数全体の下限を改めてLipschitz定数と呼ぶことにすれば，これは一意である。
\end{rem}

\begin{prop}\proplabel{Lipschitz-Lipschitz連続なら一様連続}
    $A$上Lipschitz連続な関数は$A$上一様連続である。
    \begin{proof}
        $f$を$A$上Lipschitz連続であると仮定し，Lipschitz定数の一つを$L$と記す。
        任意の正数$\varepsilon$に対して，$\delta \coloneqq \varepsilon / \pare{L+1}$と置けば，$\delta >0$であり，$\norm{x-y}<\delta = {\varepsilon}/\pare{L+1}$のとき，$L\norm{x-y}<\pare{L+1}\norm{x-y}<\varepsilon$であり，
        \begin{equation}
            \norm{\fun{f}{x} - \fun{f}{y}} \leq L \norm{x - y}<\pare{L+1}\norm{x-y}<\varepsilon
        \end{equation}
        が成立するので一様連続である。
    \end{proof}
\end{prop}

\begin{prop}\proplabel{Lipschitz-一様連続なら連続}
    $A$上一様連続な関数は$A$上連続である。
    \begin{proof}
        一般に，$\fun{P}{a,b}$を$a$, $b$に関する任意の命題としたとき，
        \begin{equation}
            \squ{\exists a;\, \forall b,\, \fun{P}{a,b}} \ \Longrightarrow\ \squ{\forall b,\, \exists a;\, \fun{P}{a,b}}
            \equlabel{Lipschitz-恒真命題 exists forall then forall exists}
        \end{equation}
        は恒真である。
        証明木を描いてみると，
        \figref{Lipschitz-恒真命題 exists forall then forall existsの証明木}に示すように，\equref{Lipschitz-恒真命題 exists forall then forall exists}が恒真であることが判る。
        \ifdraft{}{
        \begin{figure}[H]
            \centering
            \begin{prooftree}
                {
                    close with={\times},
                    to prove={
                        \squ{\exists a;\, \forall b,\, \fun{P}{a,b}}
                        \vdash
                        \squ{\forall b,\, \exists a;\, \fun{P}{a,b}}
                    }
                }
                [
                    {\exists a;\, \forall b,\, \fun{P}{a,b}}, just={Assumption}, name={Assumption}
                    [\lnot\squ{\forall b,\, \exists a;\, \fun{P}{a,b}}, just={$\lnot$ Conclusion}
                    [{\exists b;\, \lnot\squ{\exists a,\, \fun{P}{a,b}}}, just={$\lnot \forall b$ {}:!u}
                    [{\exists b;\, \forall a,\, \lnot\fun{P}{a,b}}, just={$\lnot \exists a$ {}:!u}
                    [{\forall b,\, \fun{P}{a',b}}, just={$\exists a$ {}:Assumption}
                    [{\forall a,\, \lnot \fun{P}{a,b'}}, just={$\exists b$ {}:!uu}
                    [{\fun{P}{a',b'}}, just={$\forall b$ {}:!uu}
                    [{\lnot\fun{P}{a',b'}}, just={$\forall a$ {}:!uu}, close={{}:!u,!c}
                    ]]]]]]]]
            \end{prooftree}
            \caption{\equref{Lipschitz-恒真命題 exists forall then forall exists}の証明木}
            \figlabel{Lipschitz-恒真命題 exists forall then forall existsの証明木}
        \end{figure}}
        一様連続性では$\exists \delta;\, \forall x$の順であるのに対し，連続性では$\forall x,\, \exists \delta;$の順であるから，一様連続なら連続である。
    \end{proof}
\end{prop}

\begin{cor}\corlabel{Lipschitz-Lipschitz連続なら連続}
    $A$上Lipschitz連続な関数は$A$上連続である。
    \begin{proof}
        \propref{Lipschitz-Lipschitz連続なら一様連続}と
        \propref{Lipschitz-一様連続なら連続}から直ちに従う。
    \end{proof}
\end{cor}

\begin{prop}\proplabel{Lipschitz-原始関数はLipschitz連続}
    $-\infty<a<b<\infty$とし，$I\coloneqq [a,b]$と定め，$f\colon I\to \R^n$は$I$上で有界かつ可積分とする。
    $F\colon I\to \R^n$を，
    \begin{equation}
        \fun{F}{x}\coloneqq \int_a^x dt\, \fun{f}{t}
    \end{equation}
    によって定めると，$F$は$I$上Lipschitz連続である。
    \begin{proof}
        $x,y\in I$に対し，
        \begin{equation}
            \fun{F_j}{x}-\fun{F_j}{y}=\int_a^x dt\, \fun{f_j}{t} - \int_a^y dt\, \fun{f_j}{t}=\int_y^x dt\, \fun{f_j}{t}
        \end{equation}
        である。
        $f$は$I$上で有界であるから，
        \begin{equation}
            L\coloneqq \sup_{t\in I}\bra{\norm{\fun{f}{t}}}\geq 0
        \end{equation}
        と定めておくと，$I$上で常に$\abs{\fun{f_j}{t}}\leq L$であり，\equref{実ノルム-積分絶対値不等式}により，
        \begin{equation}
            \abs{\fun{F_j}{x}-\fun{F_j}{y}}=\abs{\int_y^x dt\, \fun{f_j}{t}}
            \leq \abs{\int_x^y dt\, \abs{\fun{f_j}{t}}}\leq \abs{\int_x^y dt\, L}
            = L\abs{x-y}
        \end{equation}
        である。
        これより，$I$上の任意の$x$, $y$に関して
        \begin{equation}
            \norm{\fun{F}{x}-\fun{F}{y}}\leq L\abs{x-y}
        \end{equation}
        が成立するから，$F$は$I$上Lipschitz連続である。
    \end{proof}
\end{prop}

\begin{prop}\proplabel{Lipschitz-微分が有界ならLipschitz連続}
    $a<b$とする。
    $f\colon [a,b]\to \R^n$は$[a,b]$上で連続，$(a,b)$上で微分可能とし，$(a,b)$上で$\norm{\fun{f'}{t}}$は有限であるとする。
    このとき，$f$は$[a,b]$上でLipschitz連続である。
    \begin{proof}
        $(a,b)$上での$\norm{\fun{f'}{t}}$の有界性から，
        \begin{equation}
            L\coloneqq \sup_{t\in(a,b)}\max_{j}\bra{\abs{\fun{f'_j}{t}}}<\infty
        \end{equation}
        が定まり，$L\geq 0$である。
        $f$の各成分について，平均値の定理より，
        \begin{equation}
            \forall j\in \setN, \forall x,\forall y\in[a,b], \squ{
                x<y\, \Rightarrow\, \exists c_j\in (a,b); \pare{x<c_j<y\, \land \ \fun{f_j}{x}-\fun{f_j}{y}=\fun{f'_j}{c_j}\pare{x-y}}
            }
        \end{equation}
        が成立する。
        このような$c_j$を取ったとき，
        \begin{equation}
            \norm{\fun{f}{x}-\fun{f}{y}}=\max_{j}\bra{\abs{\fun{f_j}{x}-\fun{f_j}{y}}}
            =\max_{j}\bra{\abs{\fun{f'_j}{c_j}}\abs{x-y}}\leq L\abs{x-y}
            \equlabel{Lipschitz-f'が有界ならLipschitz連続-不等式}
        \end{equation}
        である。
        $x>y$のときにも平均値の定理により適当な定数$\tilde{c}_j$の存在が言えるので，\equref{Lipschitz-f'が有界ならLipschitz連続-不等式}は同様に成立する。
        $x=y$のとき，$\norm{0}\leq L\abs{0}$は成立するので\equref{Lipschitz-f'が有界ならLipschitz連続-不等式}も成立する。
        これより，$[a,b]$上の任意の$x$, $y$に関して
        $\norm{\fun{f}{x}-\fun{f}{y}}\leq L\abs{x-y}$の成立が言えた。
        従って，$f$はLipschitz連続である。
    \end{proof}
\end{prop}

\end{document}
